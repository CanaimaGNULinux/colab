{% extends "base.html" %}
{% load i18n form_field gravatar %}

{% block head_js %}
  {% include "pizza-chart.html" with chart_div="collabs" chart_height=300 %}
  {% include "pizza-chart.html" with chart_div="collabs2" chart_height=300 %}
{% endblock %}

{% block main-content %}
  {% if not user_profile %}
    <div class="alert alert-info alert-dismissable">
        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
      <strong>{% trans "User not registered." %}</strong> {% trans "Is that you?" %}
      <a href="{% url 'signup' %}">{% trans "Click here and sign up." %}</a>
    </div>
  {% endif %}

  <div id="user-profile" class="row">
    <div class="vcard col-lg-3 col-md-3 col-sm-4">
      <div class="thumbnail">
        {% gravatar email_address.address 200 %}
      </div>

      <h1>
        <span>{{ email_address.get_full_name }}</span>
        <em>{{ email_address.user.username }}</em>
      </h1>

      {% ifequal request.user user_profile.user %}
        <a class="btn btn-info" href="{% url 'user_profile_update' request.user %}"><span class="glyphicon glyphicon-pencil"></span>&nbsp;&nbsp;{% trans "update your profile"|title %}</a>
      {% endifequal %}

      <div class="divider"></div>

      <ul class="unstyled-list">
        {% if user_profile.institution or user_profile.role %}
        <li>
          <span class="icon-briefcase icon-fixed-width"></span>
          {{ user_profile.role }}
          {% if user_profile.institution and user_profile.role %}-{% endif %}
          {{ user_profile.institution }}
        </li>
        {% endif %}
        {% if user_profile.twitter %}
        <li><span class="icon-twitter icon-fixed-width"></span> {{ user_profile.twitter }}</li>
        {% endif %}
        {% if user_profile.facebook %}
        <li><span class="icon-facebook icon-fixed-width"></span> {{ user_profile.facebook }}</li>
        {% endif %}
        {% if user_profile.google_talk %}
        <li><span class="icon-google-plus icon-fixed-width"></span> {{ user_profile.google_talk }}</li>
        {% endif %}
        {% if user_profile.webpage %}
        <li><span class="icon-link icon-fixed-width"></span> {{ user_profile.webpage }}</li>
        {% endif %}
      </ul>
    </div>

    <div class="col-lg-5 col-md-5 col-sm-8">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">{% trans "Contributions by Area" %}</h3>
        </div>
        <div class="panel-body">
          <div id="collabs"></div>
        </div>
      </div>
    </div>


    <div class="col-lg-4 col-md-4 col-sm-8">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">{% trans "Mailing list Participation" %}</h3>
        </div>
        <div class="panel-body">
          <div id="collabs2"></div>
        </div>
      </div>
    </div>

    </div>
    <div class="row">
      <div class="col-lg-6 col-md-6 col-sm-12">
        <h3>{% trans "Latest posted" %} </h3>
        <ul class="message-list">
        {% for doc in emails %}
          {% include "message-preview.html" %}
        {% empty %}
          <li>{% trans "There are no posts by this user so far." %}</li>
        {% endfor %}
        </ul>
      </div>

      <div class="col-lg-6 col-md-6 col-sm-12">
        <h3>{% trans "Community inside participations" %}</h3>
        <ul class="message-list">
        {% for doc in docs %}
          {% include "message-preview.html" %}
        {% empty %}
          <li>{% trans "No contributions of this user so far." %}</li>
        {% endfor %}
        </ul>
      </div>

  </div>

{% endblock %}

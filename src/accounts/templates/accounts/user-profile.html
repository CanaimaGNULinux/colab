{% extends "base.html" %}
{% load i18n %}
{% load form_field %}

{% block head_js %}
  {% include "pizza-chart.html" with chart_div="collabs" chart_width=390 chart_height=230 %}
{% endblock %}

{% block main-content %}
  {% if not user_profile %}
    <span>
      <strong>{% trans "User not registered." %}</strong> {% trans "Is that you?" %}
      <a href="{% url 'signup' %}">{% trans "Click here and sign up." %}</a>
    </span>

  {% else %}

    {% ifequal request.user user_profile.user %}
      <span>
        {% trans "Hey, look at you! Do you want to " %}
        <a href="{% url 'user_profile_update' request.user %}">{% trans "update your profile" %}</a>?
      </span>
    {% endifequal %}

  {% endif %}

  <div class="row">
    <h3>{{ email_address.get_full_name }}</h3>
  </div>

  <div>&nbsp;</div>

  <div class="row">
    <div class="col-lg-1">
      <img id="profile-img" src="http://www.gravatar.com/avatar/{{ email_address.md5 }}?s=120&d=identicon" />
    </div>

    <div>
      <form action="{% url 'user_profile_update' request.user %}" method='post'>
        {% csrf_token %}

      <div class="col-lg-5 col-lg-offset-1">
        <h4 class="no-margin">{% trans "Personal Information" %}</h4>
        <ul class="none indent">
          <li>
            {% render_form_field form.institution user_profile.institution %}
          </li>
          <li>
            {% render_form_field form.role user_profile.role %}
          </li>
        </ul>
      </div>

      <div class="col-lg-5">
        <h4 class="no-margin">{% trans "Other informations" %}</h4>
        <ul class="none indent">
          <li>
            {% render_form_field form.twitter user_profile.twitter %}
          </li>
          <li>
            {% render_form_field form.facebook user_profile.facebook %}
          </li>
          <li>
            {% render_form_field form.google_talk user_profile.google_talk %}
          </li>
          <li>
            {% render_form_field form.webpage user_profile.webpage %}
          </li>
        </ul>
      </div>

        {% if editable %}
          <span>
            <input type="submit" value="{% trans 'Save' %}"/>
          </span>
        {% endif %}
      </form>

      {% if type_count %}
      <div>
        <h4 class="no-margin">{% trans "Collaborations by Area" %}</h4>
      </div>
      {% endif %}
    </div>
  </div>


  <div class="row">
    <div class="col-lg-6">
      <h3>{% trans "Latest posted" %} </h3>
      <ul>
      {% for doc in emails %}
        {% include "message-preview.html" %}
      {% empty %}
        <li>{% trans "There are no posts by this user so far." %}</li>
      {% endfor %}
      </ul>
    </div>

    <div class="col-lg-6">
      <h3>{% trans "Community inside participations" %}</h3>
      <ul class="none indent">
      {% for doc in docs %}
        {% include "message-preview.html" %}
      {% empty %}
        <li>{% trans "No contributions of this user so far." %}</li>
      {% endfor %}
      </ul>
    </div>
  </div>
{% endblock %}
